<template>
  <div class="container">
    <section id="intro">
      <div id="intro-info">
        <h1>Dr. Cheng Ling Jie (Jeremy) <span style="font-size:0.7em;">(Êõæ‰ª§Êù∞)</span></h1>
        <h2>PhD, MPH, BSN (Hons), RN</h2>
        <p class="intro-description">
Dr Cheng Ling Jie is a Postdoctoral Fellow at the <a href="https://www.npeu.ox.ac.uk/about/people/ling-jie-cheng-1110">National Perinatal Epidemiology Unit</a>, University of Oxford, supported by the prestigious <a href="https://www.moe.gov.sg/news/press-releases/20240814-28-young-singaporeans-receive-awards-to-pursue-careers-in-academia-and-research">Singapore Teaching and Academic Research Talent (START) Award</a>. He also holds an academic appointment as Senior Tutor at the <a href="https://medicine.nus.edu.sg/nursing/our-people/our-faculty/teaching-faculty/cheng-ling-jie/">Alice Lee Centre for Nursing Studies</a>, Yong Loo Lin School of Medicine, National University of Singapore.
        </p>
        
        <p class="intro-description">
His research focuses on health economics and outcomes research, with the goal of improving healthcare decision-making. He has led or contributed to projects securing over SGD 1.6 million in funding and has published more than 70 peer-reviewed articles. He has also supervised over 30 undergraduate and 8 postgraduate theses.
        </p>
        
        <p class="intro-description">
Internationally, Dr Cheng serves as a <a href="https://systematicreviewsjournal.biomedcentral.com/about/editorial-board">Senior Editor</a> for Systematic Reviews and an <a href="https://link.springer.com/journal/11136/editorial-board">Associate Editor</a> for Quality of Life Research. He is a member of the EuroQol Group Association, ISPOR, ISOQOL, and the PROMIS Health Organization, and a founding member of the EuroQol PhD Network. He is also a regular peer reviewer for leading journals in public health, nursing, and health outcomes research.
        </p>
      </div>

      <div class="intro-img-block">
        <img src="/img/CHENG-LING-JIE_NUS-OAM-9.jpg" alt="Dr Cheng Ling Jie (Jeremy)" />
        
        <div class="social-links-container">
          <div class="social-links">
            <a href="https://www.linkedin.com/in/chenglingjie/" class="social-link linkedin" target="_blank" rel="noopener noreferrer">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.5 2h-17A1.5 1.5 0 002 3.5v17A1.5 1.5 0 003.5 22h17a1.5 1.5 0 001.5-1.5v-17A1.5 1.5 0 0020.5 2zM8 19H5v-9h3zM6.5 8.25A1.75 1.75 0 118.3 6.5a1.78 1.78 0 01-1.8 1.75zM19 19h-3v-4.74c0-1.42-.6-1.93-1.38-1.93A1.74 1.74 0 0013 14.19a.66.66 0 000 .14V19h-3v-9h2.9v1.3a3.11 3.11 0 012.7-1.4c1.55 0 3.36.86 3.36 3.66z"/>
              </svg>
            </a>
            
            <a href="https://www.researchgate.net/profile/Ling-Jie-Cheng?ev=hdr_xprf" class="social-link researchgate" target="_blank" rel="noopener noreferrer">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M19.586 0H4.414A4.414 4.414 0 000 4.414v15.172A4.414 4.414 0 004.414 24h15.172A4.414 4.414 0 0024 19.586V4.414A4.414 4.414 0 0019.586 0zM8.707 19.79c-1.297 0-2.274-.702-2.274-1.297 0-.351.351-.702.702-.702.702 0 1.297.351 1.297 1.053 0 .351-.351.946-.351.946s1.648-1.405 1.648-3.243c0-1.892-1.405-3.594-3.594-3.594-1.892 0-3.243 1.351-3.243 3.243 0 1.648 1.297 2.946 2.946 2.946zM15.334 15.5c0 .405-.324.729-.729.729s-.729-.324-.729-.729v-2.7c0-.405.324-.729.729-.729s.729.324.729.729v2.7zm.729-4.374c0 .405-.324.729-.729.729s-.729-.324-.729-.729v-1.458c0-.405.324-.729.729-.729s.729.324.729.729v1.458zm.729-3.24c0 .405-.324.729-.729.729s-.729-.324-.729-.729V6.27c0-.405.324-.729.729-.729s.729.324.729.729v1.616z"/>
              </svg>
            </a>
            
            <a href="https://scholar.google.com/citations?user=IjgLMBkAAAAJ&hl=en" class="social-link scholar" target="_blank" rel="noopener noreferrer">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M5.242 13.769L0 9.5 12 0l12 9.5-5.242 4.269C17.548 11.249 14.978 9.5 12 9.5c-2.977 0-5.548 1.748-6.758 4.269zM12 10a7 7 0 1 0 0 14 7 7 0 0 0 0-14z"/>
              </svg>
            </a>
            
            <a href="https://twitter.com/JeremyChengLJ" class="social-link twitter" target="_blank" rel="noopener noreferrer">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
          </div>
          
          <div class="contact-link-row">
            <button @click="toggleChatWidget" class="social-link contact">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
              </svg>
              <span>Chat with Dr Cheng</span>
            </button>
          </div>
        </div>
      </div>
    </section>

    <section id="education" class="highlight-section">
      <h2>Education & Training</h2>
      <ul class="education-list">
        <li><strong>Postdoctoral Fellowship</strong>, University of Oxford</li>
        <li><strong>PhD in Public Health</strong>, National University of Singapore</li>
        <li><strong>Master of Public Health</strong>, National University of Singapore</li>
        <li><strong>Bachelor of Science (Nursing) (Honours)</strong>, National University of Singapore</li>
      </ul>
    </section>

    <section id="appointments" class="highlight-section appointments">
      <h2>Academic Appointments</h2>
      <ul class="appointment-list">
        <li><strong>Postdoctoral Fellow (NUS-OPF)</strong> [2024-Present], University of Oxford</li>
        <li><strong>Senior Tutor (NUS-OPF)</strong> [2024-Present], National University of Singapore</li>
        <li><strong>Research Associate</strong> [2021-2024], National University of Singapore</li>
        <li><strong>PhD Candidate</strong> [2021-2024], National University of Singapore</li>
      </ul>
    </section>

    <!-- Contact Section with Email Subscription -->
    <section id="contact">
      <h2>Contact & Locations</h2>
      
      <!-- Email Newsletter Subscription -->
      <div class="newsletter-section">
        <div class="newsletter-box">
          <h3>üìß Stay Updated with Dr. Cheng's Research</h3>
          <p>Subscribe to receive notifications about new publications, research opportunities, and collaboration invites.</p>
          <div class="newsletter-form">
            <input 
              v-model="newsletterEmail" 
              type="email" 
              placeholder="Enter your email address"
              class="newsletter-input"
              @keyup.enter="subscribeNewsletter"
            >
            <button 
              @click="subscribeNewsletter" 
              class="newsletter-btn"
              :disabled="!newsletterEmail.trim() || isSubscribing"
            >
              <span v-if="isSubscribing">Subscribing...</span>
              <span v-else>Subscribe</span>
            </button>
          </div>
          <div v-if="subscriptionMessage" class="subscription-message" :class="subscriptionStatus">
            {{ subscriptionMessage }}
          </div>
        </div>
      </div>

      <div class="two-cols">
        <div class="contact-location">
          <strong>National Perinatal Epidemiology Unit (NPEU)</strong><br>
          Nuffield Department of Population Health<br>
          University of Oxford<br>
          Old Road Campus<br>
          Oxford OX3 7LF<br>
          United Kingdom
        </div>
        <div class="contact-location">
          <strong>Alice Lee Centre for Nursing Studies (NUS Nursing)</strong><br>
          Yong Loo Lin School of Medicine<br>
          Centre for Translational Medicine<br>
          Block MD6, Level 5<br>
          14 Medical Drive<br>
          Singapore 117599
        </div>
      </div>
    </section>

    <!-- Chat Widget -->
    <div v-if="showChatWidget" class="chat-widget-overlay" @click="closeChatWidget">
      <div class="chat-widget" @click.stop>
        <div class="chat-header">
          <div class="chat-header-info">
            <div class="chat-avatar">
              <img src="/img/CHENG-LING-JIE_NUS-OAM-9.jpg" alt="Dr Cheng">
            </div>
            <div class="chat-header-text">
              <h3>Dr Cheng Ling Jie</h3>
              <span class="chat-status">{{ isOnline ? 'Online' : 'Leave a message' }}</span>
            </div>
          </div>
          <div class="chat-header-actions">
            <button @click="showAdminPanel" class="mode-toggle" title="Admin Panel (Dr Cheng only)" style="opacity: 0.3;">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM19 7V6C19 3.8 17.2 2 15 2H9C6.8 2 5 3.8 5 6V7H3V9H5V19C5 20.1 5.9 21 7 21H17C18.1 21 19 20.1 19 19V9H21V7H19ZM17 19H7V9H17V19Z"/>
              </svg>
            </button>
            <button @click="toggleMode" class="mode-toggle" :title="currentMode === 'chat' ? 'Switch to Message' : 'Switch to Chat'">
              <svg v-if="currentMode === 'chat'" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
              </svg>
              <svg v-else viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
              </svg>
            </button>
            <button @click="closeChatWidget" class="close-btn">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Chat Mode -->
        <div v-if="currentMode === 'chat'" class="chat-content">
          <!-- Visitor Information Collection -->
          <div v-if="showContactInfo" class="visitor-info-form">
            <div class="form-header">
              <h4>It sounds like you're really interested in Dr Cheng's work! üéì</h4>
              <p>Would you mind sharing your contact info? That way Dr Cheng can follow up with you directly about potential collaboration or opportunities:</p>
            </div>
            <div class="form-row">
              <input 
                v-model="visitorInfo.name" 
                placeholder="Your name" 
                class="visitor-input"
                type="text"
              >
              <input 
                v-model="visitorInfo.email" 
                placeholder="Your email" 
                type="email"
                class="visitor-input"
              >
            </div>
            <div class="form-actions">
              <button @click="collectVisitorInfo" class="collect-btn" :disabled="!visitorInfo.name.trim() || !visitorInfo.email.trim()">
                Continue Our Chat
              </button>
              <button @click="skipContactInfo" class="skip-btn">Maybe later</button>
            </div>
          </div>

          <div class="chat-messages" ref="chatMessages">
            <div v-for="message in messages" :key="message.id" class="message" :class="{ 'user': message.sender === 'user', 'assistant': message.sender === 'assistant' }">
              <div class="message-content">
                <p>{{ message.text }}</p>
                <span class="message-time">{{ message.time }}</span>
              </div>
            </div>
            <div v-if="isTyping" class="message assistant">
              <div class="message-content">
                <div class="typing-indicator">
                  <span></span>
                  <span></span>
                  <span></span>
                </div>
              </div>
            </div>
          </div>
          <div class="chat-input-area">
            <!-- Action Buttons -->
            <div class="chat-actions" v-if="messages.length > 4 && !showContactInfo">
              <button @click="requestHumanChat" class="action-btn human-btn">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V19A2 2 0 0 0 5 21H19A2 2 0 0 0 21 19V9Z"/>
                </svg>
                Connect with Dr Cheng
              </button>
              <button @click="sendChatHistory" class="action-btn email-btn" v-if="visitorInfo.collected">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                </svg>
                Email this chat
              </button>
            </div>
            
            <div class="chat-input-container">
              <input 
                v-model="currentMessage" 
                @keyup.enter="sendMessage"
                @input="handleInput"
                placeholder="Type your message..." 
                class="chat-input"
                :disabled="isTyping"
                ref="chatInput"
              >
              <button @click="sendMessage" class="send-btn" :disabled="!currentMessage.trim() || isTyping">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Message Mode -->
        <div v-else class="message-form">
          <div class="form-group">
            <label for="name">Name *</label>
            <input 
              v-model="messageForm.name" 
              type="text" 
              id="name" 
              placeholder="Your full name"
              required
            >
          </div>
          <div class="form-group">
            <label for="email">Email *</label>
            <input 
              v-model="messageForm.email" 
              type="email" 
              id="email" 
              placeholder="your.email@example.com"
              required
            >
          </div>
          <div class="form-group">
            <label for="subject">Subject *</label>
            <input 
              v-model="messageForm.subject" 
              type="text" 
              id="subject" 
              placeholder="Research collaboration, academic inquiry, etc."
              required
            >
          </div>
          <div class="form-group">
            <label for="message">Message *</label>
            <textarea 
              v-model="messageForm.message" 
              id="message" 
              rows="4" 
              placeholder="Please describe your inquiry in detail..."
              required
            ></textarea>
          </div>
          <button @click="sendFormMessage" class="submit-btn" :disabled="!isFormValid || isSubmitting">
            <span v-if="isSubmitting">Sending...</span>
            <span v-else>Send Message</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Floating Chat Button -->
    <button v-if="!showChatWidget" @click="toggleChatWidget" class="floating-chat-btn">
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
      </svg>
      <div class="chat-notification" v-if="hasNewMessage">1</div>
    </button>
  </div>
</template>

<script>
// Include EmailJS SDK: https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js
export default {
  name: 'Home',
  data: function() {
    return {
      showChatWidget: false,
      currentMode: 'chat',
      isOnline: true,
      isTyping: false,
      isSubmitting: false,
      hasNewMessage: false,
      currentMessage: '',
      showContactInfo: false,
      
      // Newsletter subscription
      newsletterEmail: '',
      isSubscribing: false,
      subscriptionMessage: '',
      subscriptionStatus: '', // 'success' or 'error'
      
      visitorInfo: {
        name: '',
        email: '',
        collected: false
      },
      messages: [
        {
          id: 1,
          sender: 'assistant',
          text: 'Hi there! üëã I\'m Dr Cheng\'s AI assistant. I\'m here to help you learn about his research in health economics and connect you with opportunities for collaboration. What brings you to his website today?',
          time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
        }
      ],
      messageForm: {
        name: '',
        email: '',
        subject: '',
        message: ''
      },
      messageIdCounter: 2,
      chatHistory: [],
      
      // Email configuration
      emailConfig: {
        serviceID: 'service_xxxxxxx', // Replace with your EmailJS service ID
        templateID: 'template_xxxxxxx', // Replace with your EmailJS template ID
        userID: 'your_user_id', // Replace with your EmailJS user ID
        
        // Template IDs for different email types
        templates: {
          newsletter: 'template_newsletter', // For newsletter subscriptions
          chatNotification: 'template_chat_notify', // For chat notifications
          formMessage: 'template_form_message', // For form messages
          chatHistory: 'template_chat_history' // For chat history emails
        }
      }
    };
  },
  computed: {
    isFormValid: function() {
      return this.messageForm.name.trim() && 
             this.messageForm.email.trim() && 
             this.messageForm.subject.trim() && 
             this.messageForm.message.trim();
    }
  },
  methods: {
    // Initialize EmailJS
    initializeEmailJS: function() {
      if (typeof emailjs !== 'undefined') {
        emailjs.init(this.emailConfig.userID);
      } else {
        console.warn('EmailJS not loaded. Email functionality will be limited.');
      }
    },
    
    // Newsletter subscription
    subscribeNewsletter: function() {
      var self = this;
      
      if (!this.newsletterEmail.trim()) return;
      
      this.isSubscribing = true;
      this.subscriptionMessage = '';
      
      var templateParams = {
        subscriber_email: this.newsletterEmail,
        subscriber_name: 'Website Visitor',
        subscription_date: new Date().toLocaleDateString(),
        dr_cheng_email: 'ethanlee2036@gmail.com' // Dr. Cheng's email
      };
      
      // Send notification to Dr. Cheng
      this.sendEmail(this.emailConfig.templates.newsletter, templateParams)
        .then(function(response) {
          console.log('Newsletter subscription successful:', response);
          self.subscriptionMessage = 'Successfully subscribed! You will receive updates about Dr. Cheng\'s research.';
          self.subscriptionStatus = 'success';
          self.newsletterEmail = '';
          
          // Store subscription locally (optional)
          if (typeof localStorage !== 'undefined') {
            var subscribers = JSON.parse(localStorage.getItem('newsletter_subscribers') || '[]');
            subscribers.push({
              email: templateParams.subscriber_email,
              date: templateParams.subscription_date
            });
            localStorage.setItem('newsletter_subscribers', JSON.stringify(subscribers));
          }
          
        })
        .catch(function(error) {
          console.error('Newsletter subscription failed:', error);
          self.subscriptionMessage = 'Subscription failed. Please try again or contact directly.';
          self.subscriptionStatus = 'error';
        })
        .finally(function() {
          self.isSubscribing = false;
          setTimeout(function() {
            self.subscriptionMessage = '';
            self.subscriptionStatus = '';
          }, 5000);
        });
    },
    
    // Enhanced email sending method
    sendEmail: function(templateId, templateParams) {
      if (typeof emailjs !== 'undefined') {
        return emailjs.send(this.emailConfig.serviceID, templateId, templateParams);
      } else {
        // Fallback: create mailto link
        var subject = encodeURIComponent(templateParams.subject || 'Website Contact');
        var body = encodeURIComponent(this.formatEmailFallback(templateParams));
        var mailtoUrl = 'mailto:ethanlee2036@gmail.com?subject=' + subject + '&body=' + body;
        window.open(mailtoUrl);
        return Promise.resolve({ status: 'fallback', message: 'Opened email client' });
      }
    },
    
    // Format email content for fallback
    formatEmailFallback: function(params) {
      var content = 'Website Contact Form\n\n';
      Object.keys(params).forEach(function(key) {
        if (key !== 'dr_cheng_email' && key !== 'service_id') {
          content += key.replace(/_/g, ' ').toUpperCase() + ': ' + params[key] + '\n';
        }
      });
      content += '\nSent from Dr. Cheng\'s website contact system.';
      return content;
    },
    
    toggleChatWidget: function() {
      this.showChatWidget = !this.showChatWidget;
      if (this.showChatWidget) {
        this.hasNewMessage = false;
        var self = this;
        this.$nextTick(function() {
          self.scrollToBottom();
          if (self.$refs.chatInput) {
            self.$refs.chatInput.focus();
          }
        });
      }
    },
    
    closeChatWidget: function() {
      this.showChatWidget = false;
    },
    
    toggleMode: function() {
      this.currentMode = this.currentMode === 'chat' ? 'message' : 'chat';
      if (this.currentMode === 'chat') {
        var self = this;
        this.$nextTick(function() {
          if (self.$refs.chatInput) {
            self.$refs.chatInput.focus();
          }
        });
      }
    },
    
    getCurrentTime: function() {
      return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    },
    
    sendMessage: function() {
      var self = this;
      
      if (!this.currentMessage.trim() || this.isTyping) return;

      // Trigger contact info collection at the 3rd message
      if (this.messages.length === 3 && !this.visitorInfo.collected) {
        this.showContactInfo = true;
        return;
      }

      var userMessage = {
        id: this.messageIdCounter++,
        sender: 'user',
        text: this.currentMessage,
        time: this.getCurrentTime()
      };
      this.messages.push(userMessage);
      
      this.chatHistory.push({
        type: 'user_message',
        content: this.currentMessage,
        timestamp: new Date().toISOString(),
        visitor: this.visitorInfo.collected ? this.visitorInfo : null
      });
      
      var messageToSend = this.currentMessage;
      this.currentMessage = '';
      
      this.$nextTick(function() {
        self.scrollToBottom();
      });

      this.isTyping = true;
      
      // Generate AI response (simplified for this example)
      setTimeout(function() {
        var response = self.generateAIResponse(messageToSend);
        
        var assistantMessage = {
          id: self.messageIdCounter++,
          sender: 'assistant',
          text: response,
          time: self.getCurrentTime()
        };
        self.messages.push(assistantMessage);
        
        self.chatHistory.push({
          type: 'assistant_response',
          content: response,
          timestamp: new Date().toISOString()
        });
        
        self.isTyping = false;
        self.$nextTick(function() {
          self.scrollToBottom();
        });
        
      }, 1000 + Math.random() * 1000);
    },
    
    generateAIResponse: function(message) {
      var lowerMsg = message.toLowerCase();
      
      if (lowerMsg.includes('how are you') || lowerMsg.includes('how\'s it going')) {
        return "I'm doing great, thank you for asking! üòä I'm here and ready to help you learn about Dr Cheng's fascinating work in health economics. What brings you to his website today?";
      }
      
      if (lowerMsg.includes('research') || lowerMsg.includes('study')) {
        return "Dr Cheng's research is fascinating! He focuses on health economics and outcomes research, working to improve healthcare decision-making through evidence-based approaches. He's particularly known for his work with quality of life measures. What aspect interests you most?";
      }
      
      if (lowerMsg.includes('collaboration') || lowerMsg.includes('collaborate')) {
        return "That's exciting! Dr Cheng loves collaborating with fellow researchers. His expertise spans health economics, quality of life research, and systematic reviews. He's currently at Oxford but maintains strong ties with Singapore. What kind of collaboration are you thinking about?";
      }
      
      return "Thanks for reaching out! I'd love to help you learn more about Dr Cheng's work in health economics and outcomes research. He's doing some really impactful work at both Oxford and Singapore. What specific aspect would you like to know more about?";
    },
    
    sendFormMessage: function() {
      var self = this;
      
      if (!this.isFormValid || this.isSubmitting) return;
      
      this.isSubmitting = true;
      
      var templateParams = {
        from_name: this.messageForm.name,
        from_email: this.messageForm.email,
        subject: this.messageForm.subject,
        message: this.messageForm.message,
        sent_date: new Date().toLocaleDateString(),
        sent_time: new Date().toLocaleTimeString(),
        dr_cheng_email: 'ethanlee2036@gmail.com'
      };
      
      this.sendEmail(this.emailConfig.templates.formMessage, templateParams)
        .then(function(response) {
          console.log('Form message sent successfully:', response);
          alert('Message sent successfully! Dr Cheng will get back to you soon.');
          
          self.messageForm = {
            name: '',
            email: '',
            subject: '',
            message: ''
          };
          
          self.closeChatWidget();
        })
        .catch(function(error) {
          console.error('Failed to send form message:', error);
          alert('Failed to send message. Please try again or contact directly.');
        })
        .finally(function() {
          self.isSubmitting = false;
        });
    },
    
    scrollToBottom: function() {
      if (this.$refs.chatMessages) {
        this.$refs.chatMessages.scrollTop = this.$refs.chatMessages.scrollHeight;
      }
    },
    
    handleInput: function() {
      // Could add typing indicators or other real-time features
    },
    
    collectVisitorInfo: function() {
      if (!this.visitorInfo.name.trim() || !this.visitorInfo.email.trim()) return;
      
      this.visitorInfo.collected = true;
      this.showContactInfo = false;
      
      this.chatHistory.push({
        type: 'visitor_info',
        content: {
          name: this.visitorInfo.name,
          email: this.visitorInfo.email
        },
        timestamp: new Date().toISOString()
      });
      
      var confirmMessage = {
        id: this.messageIdCounter++,
        sender: 'assistant',
        text: 'Perfect! Thanks ' + this.visitorInfo.name + '! üôè I\'ve saved your info and Dr Cheng will be able to reach out to you at ' + this.visitorInfo.email + ' if there are good collaboration opportunities. Now, what else would you like to know about his work?',
        time: this.getCurrentTime()
      };
      this.messages.push(confirmMessage);
      
      // Send notification email to Dr. Cheng about new visitor
      this.notifyDrChengAboutVisitor();
      
      var self = this;
      this.$nextTick(function() {
        self.scrollToBottom();
        if (self.$refs.chatInput) {
          self.$refs.chatInput.focus();
        }
      });
    },
    
    skipContactInfo: function() {
      this.showContactInfo = false;
      
      var skipMessage = {
        id: this.messageIdCounter++,
        sender: 'assistant',
        text: 'No worries at all! We can continue chatting. If you decide later that you\'d like Dr Cheng to reach out directly, just click the "Connect with Dr Cheng" button below. What else would you like to know? üòä',
        time: this.getCurrentTime()
      };
      this.messages.push(skipMessage);
      
      var self = this;
      this.$nextTick(function() {
        self.scrollToBottom();
        if (self.$refs.chatInput) {
          self.$refs.chatInput.focus();
        }
      });
    },
    
    requestHumanChat: function() {
      var self = this;
      
      if (!this.visitorInfo.collected) {
        this.showContactInfo = true;
        return;
      }
      
      var templateParams = {
        visitor_name: this.visitorInfo.name,
        visitor_email: this.visitorInfo.email,
        request_type: 'Direct Chat Request',
        request_date: new Date().toLocaleDateString(),
        request_time: new Date().toLocaleTimeString(),
        chat_summary: this.generateChatSummaryText(),
        dr_cheng_email: 'ethanlee2036@gmail.com',
        subject: 'ü§ù Direct Chat Request from ' + this.visitorInfo.name
      };
      
      this.sendEmail(this.emailConfig.templates.chatNotification, templateParams)
        .then(function(response) {
          console.log('Human chat request sent:', response);
          
          var notifyMessage = {
            id: self.messageIdCounter++,
            sender: 'assistant',
            text: 'I\'ve notified Dr Cheng about your request to chat directly. He will reach out to you at ' + self.visitorInfo.email + ' soon. In the meantime, feel free to continue our conversation or leave a detailed message using the message form.',
            time: self.getCurrentTime()
          };
          self.messages.push(notifyMessage);
          
          alert('Dr Cheng has been notified and will contact you directly!');
          
          self.$nextTick(function() {
            self.scrollToBottom();
          });
        })
        .catch(function(error) {
          console.error('Failed to send human chat request:', error);
          alert('Unable to send notification. Please try using the message form instead.');
        });
    },
    
    sendChatHistory: function() {
      var self = this;
      
      if (!this.visitorInfo.collected) {
        alert('Please provide your contact information first.');
        return;
      }
      
      var templateParams = {
        visitor_name: this.visitorInfo.name,
        visitor_email: this.visitorInfo.email,
        chat_date: new Date().toLocaleDateString(),
        chat_start_time: this.messages[0].time,
        chat_end_time: this.getCurrentTime(),
        message_count: this.messages.length,
        chat_transcript: this.formatChatTranscript(),
        dr_cheng_email: 'ethanlee2036@gmail.com',
        subject: 'üí¨ Chat History - ' + this.visitorInfo.name
      };
      
      this.sendEmail(this.emailConfig.templates.chatHistory, templateParams)
        .then(function(response) {
          console.log('Chat history sent:', response);
          
          var confirmMessage = {
            id: self.messageIdCounter++,
            sender: 'assistant',
            text: 'I\'ve emailed a copy of our conversation to both you (' + self.visitorInfo.email + ') and Dr Cheng. You should receive it shortly.',
            time: self.getCurrentTime()
          };
          self.messages.push(confirmMessage);
          
          alert('Chat history has been emailed to both parties!');
          
          self.$nextTick(function() {
            self.scrollToBottom();
          });
        })
        .catch(function(error) {
          console.error('Failed to send chat history:', error);
          alert('Unable to send email. Please try copying the conversation manually.');
        });
    },
    
    generateChatSummaryText: function() {
      return this.chatHistory.slice(-5).map(function(entry) {
        if (entry.type === 'user_message') {
          return 'üë§ Visitor: ' + entry.content;
        } else if (entry.type === 'assistant_response') {
          return 'ü§ñ AI Assistant: ' + entry.content;
        }
        return '';
      }).filter(Boolean).join('\n');
    },
    
    formatChatTranscript: function() {
      return this.messages.map(function(msg) {
        var sender = msg.sender === 'user' ? 'üë§ Visitor' : 'ü§ñ AI Assistant';
        return '[' + msg.time + '] ' + sender + ': ' + msg.text;
      }).join('\n\n');
    },
    
    notifyDrChengAboutVisitor: function() {
      var templateParams = {
        visitor_name: this.visitorInfo.name,
        visitor_email: this.visitorInfo.email,
        notification_type: 'New Visitor Contact Info',
        visit_date: new Date().toLocaleDateString(),
        visit_time: new Date().toLocaleTimeString(),
        recent_conversation: this.generateChatSummaryText(),
        dr_cheng_email: 'ethanlee2036@gmail.com',
        subject: 'üìù New Website Visitor: ' + this.visitorInfo.name
      };
      
      this.sendEmail(this.emailConfig.templates.chatNotification, templateParams)
        .then(function(response) {
          console.log('Visitor notification sent to Dr. Cheng:', response);
        })
        .catch(function(error) {
          console.error('Failed to notify Dr. Cheng about visitor:', error);
        });
    },
    
    showAdminPanel: function() {
      if (confirm('Show admin panel? (For Dr Cheng only)')) {
        var adminData = {
          totalChats: this.messages.length,
          visitorInfo: this.visitorInfo,
          chatHistory: this.chatHistory,
          lastActive: new Date().toISOString(),
          newsletterSubscribers: JSON.parse(localStorage.getItem('newsletter_subscribers') || '[]')
        };
        
        console.log('üìä Admin Panel Data:', adminData);
        
        alert('Chat Admin Info:\n' +
          'üìß Visitor: ' + (this.visitorInfo.name || 'Anonymous') + ' (' + (this.visitorInfo.email || 'No email') + ')\n' +
          'üí¨ Messages: ' + this.messages.length + '\n' +
          'üìù History entries: ' + this.chatHistory.length + '\n' +
          'üì¨ Newsletter subscribers: ' + adminData.newsletterSubscribers.length + '\n' +
          'üïê Session started: ' + ((this.messages[0] && this.messages[0].time) || 'Unknown') + '\n\n' +
          'Check console for detailed logs.');
      }
    }
  },
  
  mounted: function() {
    var self = this;
    
    // Initialize EmailJS when component is mounted
    this.initializeEmailJS();
    
    // Show new message notification after 5 seconds
    setTimeout(function() {
      if (!self.showChatWidget) {
        self.hasNewMessage = true;
      }
    }, 5000);
  }
}
</script>

<style scoped>
/* Newsletter Section */
.newsletter-section {
  margin: 30px 0 40px 0;
}

.newsletter-box {
  background: linear-gradient(135deg, #f0f7fe 0%, #e8f2ff 100%);
  border: 2px solid #e3e9f1;
  border-radius: 16px;
  padding: 28px;
  text-align: center;
  box-shadow: 0 4px 16px rgba(21, 76, 121, 0.08);
}

.newsletter-box h3 {
  color: var(--primary-blue);
  margin: 0 0 12px 0;
  font-size: 1.3em;
  font-weight: 600;
}

.newsletter-box p {
  color: #666;
  margin: 0 0 20px 0;
  line-height: 1.5;
}

.newsletter-form {
  display: flex;
  gap: 12px;
  max-width: 500px;
  margin: 0 auto;
}

.newsletter-input {
  flex: 1;
  padding: 14px 18px;
  border: 2px solid #e1e5e9;
  border-radius: 25px;
  font-size: 1em;
  outline: none;
  transition: all 0.2s;
}

.newsletter-input:focus {
  border-color: var(--primary-blue);
  box-shadow: 0 0 0 3px rgba(21, 76, 121, 0.1);
}

.newsletter-btn {
  padding: 14px 28px;
  background: var(--primary-blue);
  color: white;
  border: none;
  border-radius: 25px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.newsletter-btn:hover:not(:disabled) {
  background: #1e5a8a;
  transform: translateY(-1px);
}

.newsletter-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.subscription-message {
  margin-top: 16px;
  padding: 12px 16px;
  border-radius: 8px;
  font-weight: 500;
}

.subscription-message.success {
  background: #d4edda;
  color: #155724;
  border: 1px solid #c3e6cb;
}

.subscription-message.error {
  background: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

/* Responsive Newsletter */
@media (max-width: 768px) {
  .newsletter-form {
    flex-direction: column;
    gap: 12px;
  }
  
  .newsletter-btn {
    padding: 14px 20px;
  }
}

/* All other original styles remain the same */
#intro {
  display: flex;
  align-items: center;
  gap: 40px;
  margin-bottom: 40px;
  min-height: 600px;
}

#intro-info {
  flex: 1.2;
  min-width: 0;
}

#intro-info h1 {
  font-size: 2.2em;
  margin-bottom: 12px;
  color: var(--primary-blue);
  line-height: 1.2;
}

#intro-info h2 {
  font-size: 1.2em;
  color: var(--text-medium);
  margin-bottom: 24px;
  font-weight: 500;
}

.intro-description {
  font-size: 1.05em;
  color: var(--text-dark);
  line-height: 1.7;
  margin-bottom: 18px;
  text-align: justify;
}

.intro-description a {
  color: var(--primary-blue);
}

.intro-img-block {
  flex: 0 0 380px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 20px;
}

.intro-img-block img {
  width: 380px;
  height: 480px;
  object-fit: cover;
  object-position: center 20%;
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(21, 76, 121, 0.15);
  border: 4px solid #e3e9f1;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.intro-img-block img:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 40px rgba(21, 76, 121, 0.2);
}

.social-links-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
  width: 100%;
  max-width: 420px;
}

.social-links {
  display: flex;
  gap: 8px;
  flex-wrap: nowrap;
  justify-content: center;
  width: 100%;
}

.contact-link-row {
  display: flex;
  justify-content: center;
  width: 100%;
}

.social-link {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  background: white;
  border: 2px solid #e3e9f1;
  border-radius: 20px;
  text-decoration: none;
  font-size: 0.85em;
  font-weight: 500;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(21, 76, 121, 0.08);
  justify-content: center;
  min-width: 0;
  cursor: pointer;
}

.social-links .social-link {
  flex: 1;
  padding: 8px 10px;
  font-size: 0.8em;
}

.contact-link-row .social-link {
  padding: 10px 16px;
  font-size: 0.9em;
  min-width: 180px;
}

.social-link:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(21, 76, 121, 0.15);
}

.social-link svg {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
}

.social-links .social-link svg {
  width: 14px;
  height: 14px;
}

.social-link span {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.social-link.linkedin {
  color: #0077b5;
  border-color: #0077b5;
}

.social-link.linkedin:hover {
  background: #0077b5;
  color: white;
}

.social-link.researchgate {
  color: #00d0b6;
  border-color: #00d0b6;
}

.social-link.researchgate:hover {
  background: #00d0b6;
  color: white;
}

.social-link.scholar {
  color: #4285f4;
  border-color: #4285f4;
}

.social-link.scholar:hover {
  background: #4285f4;
  color: white;
}

.social-link.twitter {
  color: #1da1f2;
  border-color: #1da1f2;
}

.social-link.twitter:hover {
  background: #1da1f2;
  color: white;
}

.social-link.contact {
  color: var(--primary-blue);
  border-color: var(--primary-blue);
}

.social-link.contact:hover {
  background: var(--primary-blue);
  color: white;
}

h2 {
  color: var(--primary-blue);
  font-size: 1.25em;
  margin-bottom: 10px;
  border-left: 5px solid var(--primary-orange);
  padding-left: 10px;
}

.highlight-section {
  background: #f0f7fe;
  border-radius: 12px;
  padding: 28px 24px 20px 24px;
  margin-bottom: 36px;
  box-shadow: 0 2px 8px rgba(21, 76, 121, 0.06);
}

.highlight-section.appointments {
  background: #fef7e6;
}

.education-list,
.appointment-list {
  margin-left: 18px;
  margin-bottom: 10px;
}

.education-list li,
.appointment-list li {
  margin-bottom: 8px;
  line-height: 1.5;
}

.two-cols {
  display: flex;
  gap: 40px;
  flex-wrap: wrap;
}

.two-cols > div {
  flex: 1 1 300px;
  min-width: 250px;
}

.contact-location {
  background: var(--background-light);
  padding: 20px;
  border-radius: 10px;
  border-left: 4px solid var(--primary-blue);
  line-height: 1.6;
}

/* Visitor Info Form Styles */
.visitor-info-form {
  background: linear-gradient(135deg, #f8f9ff 0%, #e8f2ff 100%);
  padding: 20px;
  margin: 20px;
  border-radius: 12px;
  border: 2px solid #e3e9f1;
  width: calc(100% - 40px);
  box-sizing: border-box;
}

.form-header h4 {
  margin: 0 0 8px 0;
  color: #154c79;
  font-size: 1.1em;
}

.form-header p {
  margin: 0 0 16px 0;
  color: #666;
  font-size: 0.9em;
  line-height: 1.4;
}

.form-row {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
  width: 100%;
}

.visitor-input {
  flex: 1;
  padding: 10px 14px;
  border: 2px solid #e1e5e9;
  border-radius: 8px;
  font-size: 0.9em;
  outline: none;
  transition: border-color 0.2s;
  min-width: 0;
  width: 100%;
}

.visitor-input:focus {
  border-color: #154c79;
}

.form-actions {
  display: flex;
  gap: 10px;
}

.collect-btn,
.skip-btn {
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  font-size: 0.9em;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.collect-btn {
  background: #154c79;
  color: white;
  flex: 1;
}

.collect-btn:hover:not(:disabled) {
  background: #1e5a8a;
}

.collect-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.skip-btn {
  background: #f1f3f5;
  color: #666;
  border: 1px solid #ddd;
}

.skip-btn:hover {
  background: #e9ecef;
}

/* Chat Actions Styles */
.chat-actions {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  padding: 0 4px;
}

.action-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  background: white;
  border: 2px solid #e1e5e9;
  border-radius: 20px;
  font-size: 0.8em;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  flex: 1;
  justify-content: center;
}

.action-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(21, 76, 121, 0.1);
}

.action-btn svg {
  width: 14px;
  height: 14px;
  flex-shrink: 0;
}

.human-btn {
  color: #28a745;
  border-color: #28a745;
}

.human-btn:hover {
  background: #28a745;
  color: white;
}

.email-btn {
  color: #17a2b8;
  border-color: #17a2b8;
}

.email-btn:hover {
  background: #17a2b8;
  color: white;
}

/* Chat Widget Styles */
.chat-widget-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  padding: 20px;
}

.chat-widget {
  width: 400px;
  max-width: 90vw;
  height: 600px;
  max-height: 80vh;
  min-height: 500px;
  background: white;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.chat-header {
  background: linear-gradient(135deg, #154c79 0%, #1e5a8a 100%);
  color: white;
  padding: 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.chat-header-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.chat-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid rgba(255, 255, 255, 0.3);
}

.chat-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.chat-header-text h3 {
  margin: 0;
  font-size: 1em;
  font-weight: 600;
}

.chat-status {
  font-size: 0.8em;
  opacity: 0.9;
}

.chat-header-actions {
  display: flex;
  gap: 8px;
}

.mode-toggle,
.close-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: white;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background 0.2s;
}

.mode-toggle:hover,
.close-btn:hover {
  background: rgba(255, 255, 255, 0.2);
}

.mode-toggle svg,
.close-btn svg {
  width: 16px;
  height: 16px;
}

.chat-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  height: 0;
}

.chat-messages {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 16px;
  min-height: 0;
}

.message {
  display: flex;
}

.message.user {
  justify-content: flex-end;
}

.message.assistant {
  justify-content: flex-start;
}

.message-content {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 18px;
  position: relative;
}

.message.user .message-content {
  background: #154c79;
  color: white;
  border-bottom-right-radius: 4px;
}

.message.assistant .message-content {
  background: #f1f3f5;
  color: #333;
  border-bottom-left-radius: 4px;
}

.message-content p {
  margin: 0;
  line-height: 1.4;
}

.message-time {
  font-size: 0.7em;
  opacity: 0.7;
  display: block;
  margin-top: 4px;
}

.typing-indicator {
  display: flex;
  gap: 4px;
  align-items: center;
}

.typing-indicator span {
  width: 6px;
  height: 6px;
  background: #999;
  border-radius: 50%;
  animation: typing 1.4s infinite ease-in-out;
}

.typing-indicator span:nth-child(1) {
  animation-delay: -0.32s;
}

.typing-indicator span:nth-child(2) {
  animation-delay: -0.16s;
}

@keyframes typing {
  0%, 80%, 100% {
    transform: scale(0);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

.chat-input-area {
  padding: 16px 20px 20px 20px;
  border-top: 1px solid #e1e5e9;
  background: #f8f9fa;
  flex-shrink: 0;
}

.chat-input-container {
  display: flex;
  gap: 12px;
  align-items: center;
  min-height: 56px;
}

.chat-input {
  flex: 1;
  padding: 12px 16px;
  border: 2px solid #e1e5e9;
  border-radius: 25px;
  outline: none;
  font-size: 0.9em;
  transition: border-color 0.2s;
}

.chat-input:focus {
  border-color: #154c79;
}

.chat-input:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.send-btn {
  width: 40px;
  height: 40px;
  background: #154c79;
  border: none;
  border-radius: 50%;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
}

.send-btn:hover:not(:disabled) {
  background: #1e5a8a;
  transform: scale(1.05);
}

.send-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.send-btn svg {
  width: 18px;
  height: 18px;
}

/* Message Form Styles */
.message-form {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  color: #333;
}

.form-group input,
.form-group textarea {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #e1e5e9;
  border-radius: 8px;
  font-size: 0.9em;
  outline: none;
  transition: border-color 0.2s;
  resize: vertical;
}

.form-group input:focus,
.form-group textarea:focus {
  border-color: #154c79;
}

.submit-btn {
  width: 100%;
  padding: 14px;
  background: #154c79;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1em;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;
}

.submit-btn:hover:not(:disabled) {
  background: #1e5a8a;
}

.submit-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Floating Chat Button */
.floating-chat-btn {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 60px;
  height: 60px;
  background: #154c79;
  border: none;
  border-radius: 50%;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 8px 24px rgba(21, 76, 121, 0.3);
  transition: all 0.3s ease;
  z-index: 1000;
}

.floating-chat-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 12px 32px rgba(21, 76, 121, 0.4);
}

.floating-chat-btn svg {
  width: 24px;
  height: 24px;
}

.chat-notification {
  position: absolute;
  top: -5px;
  right: -5px;
  width: 20px;
  height: 20px;
  background: #ff4757;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8em;
  font-weight: bold;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
  100% {
    transform: scale(1);
  }
}

/* Responsive Design */
@media (max-width: 1024px) {
  .intro-img-block {
    flex: 0 0 320px;
  }
  
  .intro-img-block img {
    width: 320px;
    height: 400px;
  }
  
  #intro {
    gap: 30px;
  }
}

@media (max-width: 768px) {
  #intro {
    flex-direction: column;
    gap: 24px;
    align-items: center;
    min-height: auto;
  }

  .intro-img-block {
    flex: none;
    order: -1;
    padding-top: 0;
  }
  
  .intro-img-block img {
    width: 280px;
    height: 350px;
  }

  #intro-info {
    flex: none;
    width: 100%;
  }

  #intro-info h1 {
    text-align: center;
    font-size: 1.8em;
  }

  #intro-info h2 {
    text-align: center;
  }

  .intro-description {
    text-align: left;
  }

  .two-cols {
    flex-direction: column;
    gap: 20px;
  }
  
  .social-links-container {
    gap: 10px;
    max-width: 300px;
  }
  
  .social-links {
    gap: 6px;
  }
  
  .social-links .social-link {
    padding: 6px 8px;
    font-size: 0.75em;
  }
  
  .social-links .social-link svg {
    width: 12px;
    height: 12px;
  }
  
  .contact-link-row .social-link {
    padding: 8px 12px;
    font-size: 0.85em;
    min-width: 160px;
  }

  .chat-widget {
    width: 95vw;
    height: 85vh;
  }

  .floating-chat-btn {
    bottom: 20px;
    right: 20px;
    width: 55px;
    height: 55px;
  }
  
  .form-row {
    flex-direction: column;
    gap: 12px;
    width: 100%;
  }
  
  .visitor-input {
    width: 100%;
    min-width: auto;
  }
  
  .form-actions {
    flex-direction: column;
    gap: 8px;
  }
  
  .chat-actions {
    flex-direction: column;
    gap: 6px;
  }
  
  .action-btn {
    padding: 10px 12px;
    font-size: 0.85em;
  }
}

@media (max-width: 480px) {
  .intro-img-block img {
    width: 240px;
    height: 300px;
  }
  
  #intro-info h1 {
    font-size: 1.6em;
  }
  
  .social-links-container {
    max-width: 280px;
  }
  
  .social-links {
    gap: 4px;
  }
  
  .social-links .social-link {
    padding: 5px 6px;
    font-size: 0.7em;
  }
  
  .contact-link-row .social-link {
    padding: 7px 10px;
    font-size: 0.8em;
    min-width: 140px;
  }

  .chat-widget-overlay {
    padding: 10px;
  }

  .floating-chat-btn {
    width: 50px;
    height: 50px;
  }

  .floating-chat-btn svg {
    width: 20px;
    height: 20px;
  }
}

/* CSS Variables for consistent theming */
:root {
  --primary-blue: #154c79;
  --primary-orange: #ff6b35;
  --text-dark: #2c3e50;
  --text-medium: #576574;
  --background-light: #f8f9fa;
}
</style>
